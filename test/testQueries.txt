# Author - Milind Deshpande, Rushabh Gajab, Siddharth Sharma, Viresh Bhurke
# Purpose - Test Queries
# Version_2 - Final Project
# Date - 26 April 2024

% Test Queries

?- type(M,[int],[]).
M = typ(int)

?- variable_declaration(M,[int,x,=,6,'||'],[]).
M = var_decl(typ(int),x,=,6)

?- assignment(M,[v,=,5],[]).
M = assig(v,=,val(5))

% Tests for expression and terms
?- term(T,['(',1,')'],[]).
T = val(1)

?- term(T,[1],[]).
T = val(1)

?- term(T,['(',u,+,v,=,9,+,5,')'],[]).
T = add(term(u),+,term(store(v,=,add(val(9),+,val(5)))))

?- expression(E,[u,=,9,*,7,+,u,=,6,*,5],[]).
E = term(store(u,=,add(mul(val(9),*,val(7)),+,term(store(u,=,mul(val(6),*,val(5)))))))

?- expression(E,[u,+,v,=,9,+,5],[]).
E = add(term(u),+,term(store(v,=,add(val(9),+,val(5)))))

?- conditional_block(X,[if,'(',y,>,5,+,4,')',then,'(',y,=,6,+,5,'||',y,=,6,'||',')'],[]).
X = cond_blk(if_then_blk(cond(term(y),>,add(val(5),+,val(4))),stats(stat(assig(y,=,add(val(6),+,val(5)))),stats(stat(assig(y,=,val(6)))))))

?- statement(X,[x,=,5],[]).
X = stat(assig(x,=,val(5)))

?- statements(X,[x,=,5,'||',x,=,x,+,5,'||'],[]).
X = stats(stat(assig(x,=,val(5))),stats(stat(assig(x,=,add(term(x),+,val(5))))))

?- print_statement(J, [likhyam, '(','SER 502 Project', ')'], []).
J = print_stmt(print_stmt_Word('SER 502 Project'))

?- statement(J, [likhyam, '(','For Statement', ')'], []).
J = print_stmt(print_stmt(print_stmt_Word('For Statement')))

?- program(M,[aarambh, int,y,=,6,'||', if,'(',y,>,5,+,4,')',then,'(',y,=,6,'||',y,=,6,'||',')','||',Â antah],[]).
M = 
prgm(
blk(aarambh,decls(decl(var_decl(typ(int),y,=,6))),'||',stats(cond_blk(cond_blk(if_then_blk(cond(term(y),>,add(val(5),+,val(4))),stats(stat(assig(y,=,val(6))),stats(stat(assig(y,=,val(6))))))))),antah)
)

?- declarations(M,[int,y,=,6,'||',bool,x,=,0,'||'],[]).
M = decls(decl(var_decl(typ(int),y,=,6)),decls(decl(var_decl(typ(vrbl),x,=,0))))

?- relational_identifier(Ri,[_],[]).
Ri = <
Ri = <=
Ri = >
Ri = >=
Ri = ==
Ri = =/=

?- increment_operation(Io,[i,++],[]).
Io = incr_op(i,++)

?- increment_operation(Io,[i,--],[]).
Io = incr_op(i,--)

?- traditional_whileloop(W,[while,'(',i,<,7,')','(',x,=,7,'||',')'],[]).
W = trd_while_blk(while,cond(term(i),<,val(7)),stats(stat(assig(x,=,val(7)))))

?- traditional_whileloop(W,[while,'(',i,<,7,')','(',x,=,7,*,8,+,9,-,y,'||',')'],[]).
W = trd_while_blk(while,cond(term(i),<,val(7)),stats(stat(assig(x,=,add(mul(val(7),*,val(8)),+,sub(val(9),-,term(y)))))))

?- traditional_whileloop(W,[while,'(',i,==,7,')','(',x,=,u,'||',')'],[]).
W = trd_while_blk(while,cond(term(i),==,val(7)),stats(stat(assig(x,=,term(u)))))

?- loops(W,[while,'(',i,==,7,')','(',x,=,u,'||',')',while,'(',i,==,7,')','(',x,=,u,'||',')',while,'(',i,==,7,')','(',x,=,u,'||',')'],[]).
W = lps(lp(trd_while_blk(while,cond(term(i),==,val(7)),stats(stat(assig(x,=,term(u)))))),lps(lp(trd_while_blk(while,cond(term(i),==,val(7)),stats(stat(assig(x,=,term(u)))))),lp(trd_while_blk(while,cond(term(i),==,val(7)),stats(stat(assig(x,=,term(u))))))))

?- range_forloop(P,[for,i,in,range,'(',1,->,5,')','(',t,=,8,'||',')'],[]).
P = rng_for_loop(for,i,in,range,1,->,5,stats(stat(assig(t,=,val(8)))))

?- traditional_forloop(P, [for, '(', i, =, 9, '||',i,_,5, '||',i,_,')','(',u,=,9,'||',')'], []).
P = trd_for_blk(for,i,9,cond(term(i),<,val(5)),i,incr_op(i,++),stats(stat(assig(u,=,val(9)))))

?- statements(P,[for,i,in,range,'(',1,->,5,')','(',e,=,5,'||',')','||'],[]).
P = stats(lp(rng_for_loop(for,i,in,range,1,->,5,stats(stat(assig(e,=,val(5)))))))

?- statements(P, [for, '(', i, =, 9, '||',i,_,5, '||',i,_,')','(',s,=,5,'||',')','||'], []).
P = stats(lp(trd_for_blk(for,i,9,cond(term(i),<,val(5)),i,incr_op(i,++),stats(stat(assig(s,=,val(5)))))))

?- expression(Exp, [6,+,9,+,0,*,4,-,'(',x,+,4,')'], []), evaluator(Exp, [(x,4)], R).
Exp = add(val(6),+,add(val(9),+,sub(mul(val(0),*,val(4)),-,add(term(x),+,val(4))))),
R = 7

?- expression(Exp, [2,+,4,+,8,/,3,*,a,*,b,/,q,+,'(',5,-,i,')'], []), evaluator(Exp, [(a,4),(b,2),(q,1),(i,8)], R). (changed)
Exp = add(val(2),+,add(val(4),+,add(div(val(8),/,mul(val(3),*,mul(term(a),*,div(term(b),/,term(q))))),+,sub(val(5),-,term(i))))),
R = 3.3333333333333335

?- condition(C,[5,==,5],[]),eval_bool(C, [], Result).
Result = true

?- condition(C,[5,=/=,3],[]),eval_bool(C, [], Result).
Result = true

?- condition(C,[x,+, 9,>=,y ,-, 7],[]),eval_bool(C, [(x,4),(y,6)], Result). (changed)
C = cond(add(term(x),+,val(9)),>=,sub(term(y),-,val(7))),
Result = true

?- condition(C,[9,<=,8],[]),eval_bool(C, [], Result).
Result = false

?- variable_declaration(M,[int,x,=,6,'||'],[]),eval_var_declaration(M,[],Fin_Env).
Fin_Env = [(typ(int),x,6)],
M = var_decl(typ(int),x,=,6)

?- declaration(M,[int,x,=,6,'||'],[]),eval_decl(M,[],Fin_Env).
Fin_Env = [(typ(int),x,6)],
M = decl(var_decl(typ(int),x,=,6))

?- declarations(M,[int,x,=,6,'||'],[]),eval_decls(M,[],Fin_Env).
Fin_Env = [(typ(int),x,6)],
M = decls(decl(var_decl(typ(int),x,=,6)))

?- assignment(M,[x,=,6],[]),eval_assignment(M,[],Fin_Env).
Fin_Env = [(_,x,6)],
M = assig(x,=,val(6))

?- statement(X,[x,=,5],[]),eval_stat(M,[],NewEnv).
M = stat(assig(_A,=,val(_B))),
NewEnv = [(_,_A,_B)],
X = stat(assig(x,=,val(5)))

?- lookup(i,[(i,6)],V). (changed)
V = 6

?- increment_operation(M,[i,++],[]),eval_increment_operation(M,[(i,6)],NewEnv). (changed)
M = incr_op(i,++),
NewEnv = [(i,7)]

?- statement(M,[i,++],[]),eval_stat(M,[(i,6)],NewEnv). (changed)
M = stat(incr_op(i,++)),
NewEnv = [(i,7)]

?- traditional_whileloop(X,[while,'(',i,==,7,')','(',x,=,i,'||',i,++,'||',')'],[]),eval_while_loop(X,[(i,7),(x,1)],Fin). (changed)
Fin = [(i,8), (x,7)],
X = 
trd_while_blk(
while,
cond(term(i),==,val(7)),
stats(stat(assig(x,=,term(i))),stats(stat(incr_op(i,++))))
)

?- traditional_forloop(X,[for,'(',i,=,0,'||',i,<,5,'||',i,++,')','(',x,=,x,+,i,'||',')'],[]),eval_traditional_forloop(X,[(i,7),(x,1)],Fin). (changed)
Fin = [(i,5), (x,16)],
X = trd_for_blk(for,i,0,cond(term(i),<,val(5)),i,incr_op(i,++),stats(stat(assig(x,=,add(term(x),+,term(i))))))

?- loop(X,[for,'(',i,=,5,'||',i,<,9,'||',i,++,')','(',x,=,x,+,i,'||',')'],[]),eval_loop(X,[(i,7),(x,6)],Fin). (changed)
Fin = [(i,9), (x,36)],
X = lp(trd_for_blk(for,i,5,cond(term(i),<,val(9)),i,incr_op(i,++),stats(stat(assig(x,=,add(term(x),+,term(i)))))))

?- loops(X,[for,'(',i,=,0,'||',i,<,3,'||',i,++,')','(',x,=,x,+,i,'||',')',for,'(',i,=,9,'||',i,>,6,'||',i,--,')','(',x,=,x,+,i,'||',')'],[]),eval_loops(X,[(i,7),(x,6)],Fin). (changed)
Fin = [(i,6), (x,33)],
X = lps(lp(trd_for_blk(for,i,0,cond(term(i),<,val(3)),i,incr_op(i,++),stats(stat(assig(x,=,add(term(x),+,term(i))))))),lp(trd_for_blk(for,i,9,cond(term(i),>,val(6)),i,incr_op(i,--),stats(stat(assig(x,=,add(term(x),+,term(i))))))))

?- bool(M,[i,<,4 ,and, j,>,7],[]).
M = bool_t(cond(term(i),<,val(4)),and,cond(term(j),>,val(7)))

?- bool(M,[i,<,4 ,and, j,>,7],[]),eval_bool(M,[(i,5),(j,19)],Res).
M = bool_t(cond(term(i),<,val(4)),and,cond(term(j),>,val(7))),
Res = false

?- bool(M,[i,<,4 ,or, j,>,7],[]),eval_bool(M,[(i,5),(j,19)],Res).
M = bool_t(cond(term(i),<,val(4)),or,cond(term(j),>,val(7))),
Res = true

?- traditional_whileloop(X,[while,'(',i,<,7,and,x,<,4,')','(',x,=,i,'||',i,++,'||',')'],[]),eval_while_loop(X,[(i,1),(x,1)],Fin). 
Fin = [(i,5), (x,4)],
X = trd_while_blk(while,bool_t(cond(term(i),<,val(7)),and,cond(term(x),<,val(4))),stats(stat(assig(x,=,term(i))),stats(stat(incr_op(i,++)))))

?- traditional_whileloop(X,[while,'(',i,<,2,or,x,<,4,')','(',x,=,i,'||',i,++,'||',')'],[]),eval_while_loop(X,[(i,1),(x,1)],Fin). 
Fin = [(i,5), (x,4)],
X = trd_while_blk(while,bool_t(cond(term(i),<,val(2)),or,cond(term(x),<,val(4))),stats(stat(assig(x,=,term(i))),stats(stat(incr_op(i,++)))))

?- string_declaration(M,[string,s,=,'(',project,')','||'],[]),eval_str_declaration(M,[],P).
M = str_decl(_,s,=,project),
P = [(s,project)]

?- traditional_whileloop(X,[while,'(',not,i,<,7,')','(',x,=,i,'||',i,--,'||',')'],[]),eval_while_loop(X,[(i,12),(x,1)],Fin).
Fin = [(i,6), (x,7)],
X = trd_while_blk(while,cond(not,cond(term(i),<,val(7))),stats(stat(assig(x,=,term(i))),stats(stat(incr_op(i,--)))))

?- program(M,[aarambh, int, i, =, 8, '||', for ,i ,in ,range,'(',0,->,4,')','(', likhyam, '(', i, ')', '||', ')', '||', antah],[]),eval_program(M,[],P).
0
1
2
3
M = prgm(blk(aarambh,decls(decl(var_decl(typ(int),i,=,8))),'||',stats(lp(rng_for_loop(for,i,in,range,0,->,4,stats(print_stmt(print_stmt(term(i))))))),antah)),
P = [(i,4)]

?- program(M,[aarambh, int, c, =, 8, '||', int, m, =, 2, '||', string, b, =,'(', awesome,')', '||',string, v, =, '(',great,')', '||', if, '(',c, >, 5, or, m, <, 3, ')', then, '(', likhyam, '(', b, ')', '||', ')', else, '(', likhyam, '(', v, ')', '||', ')', '||', antah],[]),eval_program(M,[],P).
awesome
M = 
prgm(
blk(aarambh,decls(decl(var_decl(typ(int),c,=,8)),decls(decl(var_decl(typ(int),m,=,2)),decls(decl(str_decl(_,b,=,awesome)),decls(decl(str_decl(_,v,=,great)))))),'||',stats(cond_blk(cond_blk(if_then_else_blk(bool_t(cond(term(c),>,val(5)),or,cond(term(m),<,val(3))),stats(print_stmt(print_stmt(term(b)))),stats(print_stmt(print_stmt(term(v)))))))),antah)
)
,
P = [(v,great), (b,awesome), (m,2), (c,8)]

?- program(M,[aarambh, int, c, =, 8, '||', int, m, =, 2, '||', string, b, =,'(', awesome,')', '||',string, v, =, '(',great,')', '||', if, '(',c, >, 5, or, m, <, 3, ')', then, '(', likhyam, '(', b, ')', '||', ')', '||', antah],[]),eval_program(M,[],P).
awesome
M = prgm(blk(aarambh,decls(decl(var_decl(typ(int),c,=,8)),decls(decl(var_decl(typ(int),m,=,2)),decls(decl(str_decl(_,b,=,awesome)),decls(decl(str_decl(_,v,=,great)))))),'||',stats(cond_blk(cond_blk(if_then_blk(bool_t(cond(term(c),>,val(5)),or,cond(term(m),<,val(3))),stats(print_stmt(print_stmt(term(b)))))))),antah)),
P = [(v,great), (b,awesome), (m,2), (c,8)]