# Author - Milind Deshpande, Rushabh Gajab, Siddharth Sharma, Viresh Bhurke
# Purpose - Test Queries
# Version - Final
# Date - 23 April 2024

% Test Queries

?- type(M,[int],[]).
M = typ(int)

?- variable_declaration(M,[int,x,=,6,'||'],[]).
M = var_decl(typ(int),x,=,6)

?- assignment(M,[v,=,5],[]).
M = assig(v,=,5)

% Tests for expression and terms
?- term(T,['(',1,')'],[]).
T = val(1)

?- term(T,[1],[]).
T = val(1)

?- term(T,['(',u,+,v,=,9,+,5,')'],[]).
T = add(term(u),+,term(store(v,=,add(val(9),+,val(5)))))

?- expression(E,[u,=,9,*,7,+,u,=,6,*,5],[]).
E = term(store(u,=,add(mul(val(9),*,val(7)),+,term(store(u,=,mul(val(6),*,val(5)))))))

?- expression(E,[u,+,v,=,9,+,5],[]).
E = add(term(u),+,term(store(v,=,add(val(9),+,val(5)))))

?- conditional_block(X,[if,'(',y,>,5,+,4,')',then,'(',y,=,6,+,5,'||',y,=,6,'||',')'],[]).
X = cond_blk(if_then_blk(cond(term(y),>,add(val(5),+,val(4))),stats(stat(assig(y,=,add(val(6),+,val(5)))),stats(stat(assig(y,=,val(6)))))))

?- statement(X,[x,=,5],[]).
X = stat(assig(x,=,val(5)))

?- statements(X,[x,=,5,'||',x,=,x,+,5,'||'],[]).
X = stats(stat(assig(x,=,val(5))),stats(stat(assig(x,=,add(term(x),+,val(5))))))

?- print_statement(J, [likhyam, '(','SER 502 Project', ')'], []).
J = print_stmt(print_stmt_Word('SER 502 Project'))

?- statement(J, [likhyam, '(','For Statement', ')'], []).
J = print_stmt(print_stmt(print_stmt_Word('For Statement')))

?- program(M,[aarambh, int,y,=,6,'||', if,'(',y,>,5,+,4,')',then,'(',y,=,6,'||',y,=,6,'||',')','||',Â antah],[]).
M = prgm(blk(aarambh,decls(decl(var_decl(typ(int),y,=,6))),stats(cond_blk(cond_blk(if_then_blk(cond(term(y),>,add(val(5),+,val(4))),stats(stat(assig(y,=,val(6))),stats(stat(assig(y,=,val(6))))))))),antah))

?- declarations(M,[int,y,=,6,'||',bool,x,=,0,'||'],[]).
M = decls(decl(var_decl(typ(int),y,=,6)),decls(decl(var_decl(typ(vrbl),x,=,0))))

?- relational_identifier(Ri,[_],[]).
Ri = <
Ri = <=
Ri = >
Ri = >=
Ri = ==
Ri = =/=

?- increment_operation(Io,[i,++],[]).
Io = incr_op(i,++)

?- increment_operation(Io,[i,--],[]).
Io = incr_op(i,--)

?- traditional_whileloop(W,[while,'(',i,<,7,')','(',x,=,7,'||',')'],[]).
W = trd_while_blk(while,cond(term(i),<,val(7)),stats(stat(assig(x,=,val(7)))))

?- traditional_whileloop(W,[while,'(',i,<,7,')','(',x,=,7,*,8,+,9,-,y,'||',')'],[]).
W = trd_while_blk(while,cond(term(i),<,val(7)),stats(stat(assig(x,=,add(mul(val(7),*,val(8)),+,sub(val(9),-,term(y)))))))

?- traditional_whileloop(W,[while,'(',i,==,7,')','(',x,=,u,'||',')'],[]).
W = trd_while_blk(while,cond(term(i),==,val(7)),stats(stat(assig(x,=,term(u)))))

?- loops(W,[while,'(',i,==,7,')','(',x,=,u,'||',')',while,'(',i,==,7,')','(',x,=,u,'||',')',while,'(',i,==,7,')','(',x,=,u,'||',')'],[]).
W = lps(lp(trd_while_blk(while,cond(term(i),==,val(7)),stats(stat(assig(x,=,term(u)))))),lps(lp(trd_while_blk(while,cond(term(i),==,val(7)),stats(stat(assig(x,=,term(u)))))),lp(trd_while_blk(while,cond(term(i),==,val(7)),stats(stat(assig(x,=,term(u))))))))

?- range_forloop(P,[for,i,in,range,'(',1,->,5,')','(',t,=,8,'||',')'],[]).
P = rng_for_loop(for,i,in,range,1,->,5,stats(stat(assig(t,=,val(8)))))

?- traditional_forloop(P, [for, '(', i, =, 9, '||',i,_,5, '||',i,_,')','(',u,=,9,'||',')'], []).
P = trd_for_blk(for,i,9,cond(term(i),<,val(5)),i,incr_op(i,++),stats(stat(assig(u,=,val(9)))))

?- statements(P,[for,i,in,range,'(',1,->,5,')','(',e,=,5,'||',')','||'],[]).
P = stats(lp(rng_for_loop(for,i,in,range,1,->,5,stats(stat(assig(e,=,val(5)))))))

?- statements(P, [for, '(', i, =, 9, '||',i,_,5, '||',i,_,')','(',s,=,5,'||',')','||'], []).
P = stats(lp(trd_for_blk(for,i,9,cond(term(i),<,val(5)),i,incr_op(i,++),stats(stat(assig(s,=,val(5)))))))

?- expression(Exp, [6,+,9,+,0,*,4,-,'(',x,+,4,')'], []), evaluator(Exp, [(x,4)], R).
Exp = add(val(6),+,add(val(9),+,sub(mul(val(0),*,val(4)),-,add(term(x),+,val(4))))),
R = 7

?- expression(Exp, [2,+,4,+,8,/,3,*,a,*,b,/,q,+,'(',5,-,i,')'], []), evaluator(Exp, [(int,a,4),(int,b,2),(int,q,1),(int,i,8)], R).
Exp = add(val(2),+,add(val(4),+,add(div(val(8),/,mul(val(3),*,mul(term(a),*,div(term(b),/,term(q))))),+,sub(val(5),-,term(i))))),
R = 3.3333333333333335

?- condition(C,[5,==,5],[]),eval_bool(C, [], Result).
Result = true

?- condition(C,[5,=/=,3],[]),eval_bool(C, [], Result).
Result = true

?- condition(C,[x,+, 9,>=,y ,-, 7],[]),eval_bool(C, [(int,x,4),(int,y,6)], Result).
Result = true

?- condition(C,[9,<=,8],[]),eval_bool(C, [], Result).
Result = false

?- variable_declaration(M,[int,x,=,6,'||'],[]),eval_var_declaration(M,[],Fin_Env).
Fin_Env = [(typ(int),x,6)],
M = var_decl(typ(int),x,=,6)

?- declaration(M,[int,x,=,6,'||'],[]),eval_decl(M,[],Fin_Env).
Fin_Env = [(typ(int),x,6)],
M = decl(var_decl(typ(int),x,=,6))

?- declarations(M,[int,x,=,6,'||'],[]),eval_decls(M,[],Fin_Env).
Fin_Env = [(typ(int),x,6)],
M = decls(decl(var_decl(typ(int),x,=,6)))

?- assignment(M,[x,=,6],[]),eval_assignment(M,[],Fin_Env).
Fin_Env = [(_,x,6)],
M = assig(x,=,val(6))

?- statement(X,[x,=,5],[]),eval_stat(M,[],NewEnv).
M = stat(assig(_A,=,val(_B))),
NewEnv = [(_,_A,_B)],
X = stat(assig(x,=,val(5)))

?- lookup(int,i,[(int,i,6)],V).
V = 6

?- increment_operation(M,[i,++],[]),eval_increment_operation(M,[(int,i,6)],NewEnv).
M = incr_op(i,++),
NewEnv = [(int,i,7)]

?- statement(M,[i,++],[]),eval_stat(M,[(int,i,6)],NewEnv).
M = stat(incr_op(i,++)),
NewEnv = [(int,i,7)]

?- traditional_whileloop(X,[while,'(',i,==,7,')','(',x,=,i,'||',i,++,'||',')'],[]),eval_while_loop(X,[(int,i,7),(int,x,1)],Fin).
Fin = [(int,i,8), (int,x,7)],
X = trd_while_blk(while,cond(term(i),==,val(7)),stats(stat(assig(x,=,term(i))),stats(stat(incr_op(i,++)))))

?- traditional_forloop(X,[for,'(',i,=,0,'||',i,<,5,'||',i,++,')','(',x,=,x,+,i,'||',')'],[]),eval_traditional_forloop(X,[(int,i,7),(int,x,1)],Fin).
Fin = [(int,i,5), (int,x,16)],
X = trd_for_blk(for,i,0,cond(term(i),<,val(5)),i,incr_op(i,++),stats(stat(assig(x,=,add(term(x),+,term(i))))))

?- loop(X,[for,'(',i,=,5,'||',i,<,9,'||',i,++,')','(',x,=,x,+,i,'||',')'],[]),eval_loop(X,[(int,i,7),(int,x,6)],Fin).
Fin = [(int,i,9), (int,x,36)],
X = lp(trd_for_blk(for,i,5,cond(term(i),<,val(9)),i,incr_op(i,++),stats(stat(assig(x,=,add(term(x),+,term(i)))))))

?- loops(X,[for,'(',i,=,0,'||',i,<,3,'||',i,++,')','(',x,=,x,+,i,'||',')',for,'(',i,=,9,'||',i,>,6,'||',i,--,')','(',x,=,x,+,i,'||',')'],[]),eval_loops(X,[(int,i,7),(int,x,6)],Fin).
Fin = [(int,i,6), (int,x,33)],
X = lps(lp(trd_for_blk(for,i,0,cond(term(i),<,val(3)),i,incr_op(i,++),stats(stat(assig(x,=,add(term(x),+,term(i))))))),lp(trd_for_blk(for,i,9,cond(term(i),>,val(6)),i,incr_op(i,--),stats(stat(assig(x,=,add(term(x),+,term(i))))))))


